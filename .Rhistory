##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='id', all=TRUE)%>%
filter(!is.na(total_mass_g))
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(janitor)
library(vegan)
library(tidyverse)
library(bioseq)
library(phyloseq)
library(kmer)
library(dada2)
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='id', all=TRUE)%>%
filter(!is.na(total_mass_g))
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(janitor)
library(vegan)
library(tidyverse)
library(bioseq)
library(phyloseq)
library(kmer)
library(dada2)
#size = read_csv(here("data", "ghecto_pilot_sizemetrics.csv"))%>%
#  clean_names()
size= read_csv(here("data", "ghecto_repotting_seedling_data.csv")) %>%
clean_names()
biomass = read_csv(here("data", "ghecto_pilot_biomass.csv"))%>%
clean_names()
community = read_csv(here("data", "seedling_measurements.csv")) %>%
clean_names()
destructive.fasta = here("data", "tip_seqs", "destructive", "scf_trimmed.fasta")
destructive.dnabin = ape::read.dna(destructive.fasta, format= "fasta")
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='id', all=TRUE)%>%
filter(!is.na(total_mass_g))
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(janitor)
library(lubridate)
#library(calecopal)
library(tidyverse)
library(dplyr)
library(vegan)
tips = read_csv(here("data", "ghecto_repotting_root_pulling_data.csv")) %>%
mutate(pct_colonization = colonization_numerator/ colonization_denominator) %>%
rename(id = seedling_id)
tips_longer = tips %>%
pivot_longer(cols=6:13, names_to = "row", values_to = "morphotype") %>%
mutate(m_2nd = substr(morphotype, 2,2)) %>%
mutate(morphotype = substr(morphotype, 1,1)) %>%
mutate(questionable = case_when(
morphotype == "Q" ~ 1,
m_2nd == "Q" ~ 1)) %>%
mutate(questionable = case_when(
questionable == 1 ~ 1,
is.na(questionable) ~ 0)) %>%
select(-m_2nd) %>%
mutate(plate_short = substr(plate, 5,6))
tip_ids = tips_longer %>%
filter(!is.na(morphotype))
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='id', all=TRUE)%>%
filter(!is.na(total_mass_g))
View(desttips.plate)
class(biomass$id)
class(tips$id)
tips = read_csv(here("data", "ghecto_repotting_root_pulling_data.csv")) %>%
mutate(pct_colonization = colonization_numerator/ colonization_denominator) %>%
rename(id = seedling_id)
#size = read_csv(here("data", "ghecto_pilot_sizemetrics.csv"))%>%
#  clean_names()
size= read_csv(here("data", "ghecto_repotting_seedling_data.csv")) %>%
clean_names()
biomass = read_csv(here("data", "ghecto_repotting_destruction.csv"))%>%
clean_names()
community = read_csv(here("data", "seedling_measurements.csv")) %>%
clean_names()
destructive.fasta = here("data", "tip_seqs", "destructive", "scf_trimmed.fasta")
destructive.dnabin = ape::read.dna(destructive.fasta, format= "fasta")
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='id', all=TRUE)%>%
filter(!is.na(total_mass_g))
biomass
tips
tips = read_csv(here("data", "ghecto_repotting_root_pulling_data.csv")) %>%
mutate(pct_colonization = colonization_numerator/ colonization_denominator)
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='id', all=TRUE)%>%
filter(!is.na(total_mass_g))
biomass
tips
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)%>%
filter(!is.na(total_mass_g))
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)#%>%
View(desttips.plate)
View(desttips.plate)
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)#%>%
filter(!is.na(wet_above_g))
View(desttips.plate)
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)
View(desttips.plate)
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)#%>%
filter(!is.na(wet_below_g))
desttips.plate
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)#%>%
filter(!is.na(wet_above_g))
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)%>%
filter(!is.na(wet_above_g))
View(dest_tips)
ecto.tips <- read_csv(here("data", "ecto_desttips_10122022.csv")) %>%
clean_names()
View(ecto.tips)
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)%>%
filter(!is.na(wet_above_g)) %>%
x$plate <- substring(x$plate, nchar(as.character(x$plate)) - 4)
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)%>%
filter(!is.na(wet_above_g)) %>%
plate <- substring(plate, nchar(as.character(plate)) - 4)
View(dest_tips)
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)%>%
filter(!is.na(wet_above_g)) %>%
mutate(plate=substr(plate,nchar(plate)-4)
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)%>%
filter(!is.na(wet_above_g)) %>%
mutate(plate=substr(plate,nchar(plate)-4))
View(biomass)
ecto.tips
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)%>%
filter(!is.na(wet_above_g)) %>%
mutate(plate=substr(plate,nchar(plate)-4,nchar(plate)-6)
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)%>%
filter(!is.na(wet_above_g)) %>%
mutate(plate=substr(plate,nchar(plate)-4,nchar(plate)-6))
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)%>%
filter(!is.na(wet_above_g)) %>%
mutate(plate=substr(plate,nchar(plate)-4,nchar(plate)-5))
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)%>%
filter(!is.na(wet_above_g)) %>%
mutate(plate=substr(plate,nchar(plate)-3,nchar(plate)-4))
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips, by='seedling_id', all=TRUE)%>%
filter(!is.na(wet_above_g)) %>%
mutate(plate=substr(plate,nchar(plate)-1,nchar(plate)))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)
View(desttips.ecto)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(!is.na(sequence))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))
View(potting)
View(neighbor.facts)
View(post_repotting)
View(community)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
desttips.ecto[,c('seedling_id', 'plate.x', 'column.x')]
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
desttips.ecto[c('seedling_id', 'plate.x', 'column.x')]
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
desttips.ecto[ , c('seedling_id', 'plate.x', 'column.x')]
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(c= 'seedling_id', 'plate.x', 'column.x')]
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(c= 'seedling_id', 'plate.x', 'column.x')
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(desttips.ecto,c('seedling_id', 'plate.x', 'column.x'))
View(biomass)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
select('seedling_id', 'plate.x', 'column.x')
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset('seedling_id', 'plate.x', 'column.x')
View(desttips.plate)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(desttips.ecto, 'seedling_id', 'plate.x', 'column.x')
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(desttips.ecto, ('seedling_id', 'plate.x', 'column.x'))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(desttips.ecto, ('seedling_id' 'plate.x' 'column.x'))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(desttips.ecto, ,select=c('seedling_id', 'plate.x', 'column.x'))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(desttips.ecto,select=c('seedling_id', 'plate.x', 'column.x'))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
df[,c('seedling_id', 'plate.x', 'column.x')]
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
df(,c('seedling_id', 'plate.x', 'column.x'))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
desttips.ecto(,c('seedling_id', 'plate.x', 'column.x'))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))%>%
merge(desttips.ecto, community, by='seedling_id', all=TRUE)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
merge(desttips.ecto, community, by='seedling_id', all=TRUE)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))%>%
merge(community,desttips.ecto, by='seedling_id', all=TRUE)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
merge(community,desttips.ecto, by='seedling_id', all=TRUE)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
desttips.ecto2 <- merge(community,desttips.ecto, by='seedling_id', all=TRUE)
View(desttips.ecto2)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
desttips.ecto2 <- merge(desttips.ecto, community, by='seedling_id', all=TRUE)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
desttips.ecto2 <- merge(community, desttips.ecto, by='seedling_id')
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))%>%
merge(community, desttips.ecto, by='seedling_id')
merge(community, desttips.ecto, by='seedling_id')
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')
View(desttips.remaining)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'seedling_sp', 'soil_type'))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'seedling_sp', 'soil_type'))%>%
filter(!is.C(soil_type))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'seedling_sp', 'soil_type'))%>%
filter(soil_type = C)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'seedling_sp', 'soil_type'))%>%
filter(soil_type == C)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'seedling_sp', 'soil_type'))%>%
filter(soil_type != C)
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'seedling_sp', 'soil_type'))%>%
filter(desttips.remaining, soil_type !== C)
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'seedling_sp', 'soil_type'))%>%
filter(desttips.remaining, soil_type != C)
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'seedling_sp', 'soil_type'))%>%
filter(desttips.remaining, soil_type != 'C')
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'seedling_sp', 'soil_type'))%>%
filter(desttips.remaining, soil_type !== 'C')
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'seedling_sp', 'soil_type'))%>%
filter(soil_type %in% c('Q', 'P'))
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(janitor)
library(lubridate)
#library(calecopal)
library(tidyverse)
library(dplyr)
library(vegan)
tips = read_csv(here("data", "ghecto_repotting_root_pulling_data.csv")) %>%
mutate(pct_colonization = colonization_numerator/ colonization_denominator)
tips_longer = tips %>%
pivot_longer(cols=6:13, names_to = "row", values_to = "morphotype") %>%
mutate(m_2nd = substr(morphotype, 2,2)) %>%
mutate(morphotype = substr(morphotype, 1,1)) %>%
mutate(questionable = case_when(
morphotype == "Q" ~ 1,
m_2nd == "Q" ~ 1)) %>%
mutate(questionable = case_when(
questionable == 1 ~ 1,
is.na(questionable) ~ 0)) %>%
select(-m_2nd) %>%
mutate(plate_short = substr(plate, 5,6))
tip_ids = tips_longer %>%
filter(!is.na(morphotype))
View(tips_longer)
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(janitor)
library(vegan)
library(tidyverse)
library(bioseq)
library(phyloseq)
library(kmer)
library(dada2)
#size = read_csv(here("data", "ghecto_pilot_sizemetrics.csv"))%>%
#  clean_names()
size= read_csv(here("data", "ghecto_repotting_seedling_data.csv")) %>%
clean_names()
biomass = read_csv(here("data", "ghecto_repotting_destruction.csv"))%>%
clean_names()
community = read_csv(here("data", "seedling_measurements.csv")) %>%
clean_names()
destructive.fasta = here("data", "tip_seqs", "destructive", "scf_trimmed.fasta")
destructive.dnabin = ape::read.dna(destructive.fasta, format= "fasta")
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips_longer, by='seedling_id', all=TRUE)%>%
filter(!is.na(wet_above_g)) %>%
mutate(plate=substr(plate,nchar(plate)-1,nchar(plate)))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
ecto.tips <- read_csv(here("data", "ecto_desttips_10122022.csv")) %>%
clean_names()
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x'))
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'seedling_sp', 'soil_type'))%>%
filter(soil_type %in% c('Q', 'P'))
View(desttips.remaining)
View(desttips.plate)
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'row))
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'row'))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'row'))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'row.x'))
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'seedling_sp', 'soil_type'))%>%
filter(soil_type %in% c('Q', 'P'))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'row.x'))
desttips.remaining<- merge(community, desttips.ecto, by='seedling_id')%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'row.x', 'seedling_sp', 'soil_type'))%>%
filter(soil_type %in% c('Q', 'P'))
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(janitor)
library(vegan)
library(tidyverse)
library(bioseq)
library(phyloseq)
library(kmer)
library(dada2)
#size = read_csv(here("data", "ghecto_pilot_sizemetrics.csv"))%>%
#  clean_names()
size= read_csv(here("data", "ghecto_repotting_seedling_data.csv")) %>%
clean_names()
biomass = read_csv(here("data", "ghecto_repotting_destruction.csv"))%>%
clean_names()
community = read_csv(here("data", "seedling_measurements.csv")) %>%
clean_names()
destructive.fasta = here("data", "tip_seqs", "destructive", "scf_trimmed.fasta")
destructive.dnabin = ape::read.dna(destructive.fasta, format= "fasta")
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(janitor)
library(vegan)
library(tidyverse)
library(bioseq)
library(phyloseq)
library(kmer)
library(dada2)
taxa.tib = read_csv(here("data", "destructive_tips_20_2021.csv")) %>%
mutate(sample = destructive.tibble$plate_location) %>%
rename(sequence = ...1) %>%
mutate(plate = as.numeric(substr(sample,2,3))) %>%
mutate(column = as.numeric(substr(sample,5,6)))%>%
mutate(well = substr(sample,7,7))
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(janitor)
library(vegan)
library(tidyverse)
library(bioseq)
library(phyloseq)
library(kmer)
library(dada2)
taxa.tib = read_csv(here("data", "destructive_tips_20_2021.csv")) %>%
mutate(sample = destructive.tibble$plate_location) %>%
rename(sequence = ...1) %>%
mutate(plate = as.numeric(substr(sample,2,3))) %>%
mutate(column = as.numeric(substr(sample,5,6)))%>%
mutate(well = substr(sample,7,7))
#size = read_csv(here("data", "ghecto_pilot_sizemetrics.csv"))%>%
#  clean_names()
size= read_csv(here("data", "ghecto_repotting_seedling_data.csv")) %>%
clean_names()
biomass = read_csv(here("data", "ghecto_repotting_destruction.csv"))%>%
clean_names()
community = read_csv(here("data", "seedling_measurements.csv")) %>%
clean_names()
#destructive.fasta = here("data", "tip_seqs", "destructive", "scf_trimmed.fasta")
#destructive.dnabin = ape::read.dna(destructive.fasta, format= "fasta")
destructive.otus = otu(destructive.dnabin)
taxa.tib = read_csv(here("data", "destructive_tips_20_2021.csv")) %>%
mutate(sample = destructive.tibble$plate_location) %>%
rename(sequence = ...1) %>%
mutate(plate = as.numeric(substr(sample,2,3))) %>%
mutate(column = as.numeric(substr(sample,5,6)))%>%
mutate(well = substr(sample,7,7))
tips_consensus = read_csv(here("data", "tip_seqs","destructive", "june_22_consensus.csv")) %>%
clean_names() %>%
dplyr::select(name, sequence) %>%
rename(sequence_list_name = name)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
mutate(column = gsub("[^0-9.-]","",location)) %>%
mutate(row = gsub("[[:digit:]]","",location))
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names()
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv"))
sanger_sheet = master_contigs %>%
left_join(sample_locations) %>%
mutate(newplate = substr(newplate, 5, 6)) %>%
select(-pcr_plate, -pcr_column, -pcr_row, -x)
sos_tiptaxa = read_csv(here("data", "sos_tiptaxa_sanger_contigs1.csv"))
ecto.tips <- read_csv(here("data", "ecto_desttips_10122022.csv")) %>%
clean_names()
##match "biomass" sheet w "tips" plate number sheet
desttips.plate <- merge(biomass, tips_longer, by='seedling_id', all=TRUE)%>%
filter(!is.na(wet_above_g)) %>%
mutate(plate=substr(plate,nchar(plate)-1,nchar(plate)))
desttips.ecto <- merge(desttips.plate, ecto.tips, by='seedling_id', all=TRUE)%>%
filter(is.na(sequence))%>%
subset(,c('seedling_id', 'plate.x', 'column.x', 'row.x'))
taxa.tib = read_csv(here("data", "destructive_tips_20_2021.csv")) %>%
mutate(sample = destructive.tibble$plate_location) %>%
rename(sequence = ...1) %>%
mutate(plate = as.numeric(substr(sample,2,3))) %>%
mutate(column = as.numeric(substr(sample,5,6)))%>%
mutate(well = substr(sample,7,7))
#size = read_csv(here("data", "ghecto_pilot_sizemetrics.csv"))%>%
#  clean_names()
size= read_csv(here("data", "ghecto_repotting_seedling_data.csv")) %>%
clean_names()
biomass = read_csv(here("data", "ghecto_repotting_destruction.csv"))%>%
clean_names()
community = read_csv(here("data", "seedling_measurements.csv")) %>%
clean_names()
#destructive.fasta = here("data", "tip_seqs", "destructive", "scf_trimmed.fasta")
#destructive.dnabin = ape::read.dna(destructive.fasta, format= "fasta")
destructive.otus = otu(destructive.dnabin)
unite.seqs = destructive.tibble
