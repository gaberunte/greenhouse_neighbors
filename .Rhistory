mutate(timepoint = "5")%>%
mutate(month = lubridate::my(122021))
t6 = read_csv(here("data", "seedling_measurements_winter22.csv")) %>%
clean_names() %>%
mutate(timepoint = "6")%>%
mutate(month = lubridate::my(022022))
#which seedling was paired with which other seedling? they share a pot number
potting = read_csv(here("data", "ghecto_neighbor_pairs.csv")) %>%
clean_names()
seedling_sizes = t3 %>%
bind_rows(t4, t5, t6)
seedling_size = seedling_sizes %>%
left_join(seedlings)
master_full = seedling_size %>%
left_join(potting, by= c("seedling_id" = "seedling_1" )) %>%
left_join(potting, by= c("seedling_id" = "seedling_2" )) %>%
mutate(pot = case_when(
!is.na(pot.x) ~ pot.x,
!is.na(pot.y) ~ pot.y,
)) %>%
mutate(neighbor = case_when(
!is.na(seedling_1) ~ seedling_1,
!is.na(seedling_2) ~ seedling_2,
)) %>%
dplyr::select(!c("pot.x", "pot.y", "seedling_1", "seedling_2")) %>%
filter(timepoint>3)
all3 = master_full %>%
group_by(seedling_id) %>%
summarize(n = n()) %>%
filter(n ==3)
master = master_full %>%
filter(seedling_id %in% all3$seedling_id)  %>%
mutate(total_length = height_cm + additional_height)
help = master %>%
group_by(seedling_id) %>%
summarize(n = n()) %>%
filter(n !=3)
problems = master_full %>%
filter(is.na(pot))
#finished BM
oaks = seedling_size %>%
filter(seedling_sp == "Q")%>%
mutate(zheight = (height_cm- mean(height_cm))/sd(height_cm))%>%
mutate(zdiameter = (diameter_mm- mean(diameter_mm))/sd(diameter_mm))
bigcone = seedling_size %>%
filter(seedling_sp == "P")%>%
mutate(zheight = (height_cm- mean(height_cm))/sd(height_cm))%>%
mutate(zdiameter = (diameter_mm- mean(diameter_mm))/sd(diameter_mm))%>%
filter(height_cm < 10)
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(RColorBrewer)
seedling.measurements.april2022= read.csv(here("Data", "measurements april 2022.csv"))%>%
clean.names()
seedling.measurements.april2022= read.csv(here("Data", "measurements april 2022.csv"))%>%
clean_names()
lmo1 = lm(growth~soil_type*neighb.spp*neighb.soil, data=m5.oak)
seedling.measurements.april2022= read.csv(here("Data", "measurements april 2022.csv"))%>%
clean_names()+
left_join(seedling_size %>%
seedling.measurements.april2022= read.csv(here("Data", "measurements april 2022.csv"))%>%
clean_names()+
left_join(seedling_size)
seedling.measurements.april2022= read.csv(here("Data", "measurements april 2022.csv"))%>%
clean_names()+
seedling.measurements.april2022= read.csv(here("Data", "measurements april 2022.csv"))%>%
clean_names()
seedling.measurements.april2022= read.csv(here("Data", "measurements april 2022.csv"))%>%
clean_names() %>%
left_join(seedling.measurements)
seedling.measurements.april2022= read.csv(here("Data", "measurements april 2022.csv"))%>%
clean_names() %>%
left_join(seedling_size)
View(seedling.measurements.april2022)
seedling.measurements.april2022= read.csv(here("Data", "measurements april 2022.csv"))%>%
clean_names() %>%
seedling.measurements.april2022.clean  = bind_rows(seedling.measurements.april2022, seedling_size)
seedling.measurements.april2022= read.csv(here("Data", "measurements april 2022.csv"))%>%
clean_names() %>%
seedling.measurements.april2022= read.csv(here("Data", "measurements april 2022.csv"))%>%
clean_names()
seedling.measurements.april2022= read.csv(here("Data", "measurements april 2022.csv"))%>%
clean_names()
knitr::opts_chunk$set(echo = TRUE)
sos_consensus = read_csv(here("data", "sanger", "june_22_consensus.csv")) %>%
clean_names() %>%
dplyr::select(name, sequence) %>%
rename(sequence_list_name = name)
sos_consensus = read_csv(here("data", "sanger", "june_22_consensus.csv"))%>%
clean_names() %>%
dplyr::select(name, sequence) %>%
rename(sequence_list_name = name)
sos_consensus = read_csv(here("data", "sanger", "june_22_consensus.csv")) %>%
clean_names() %>%
dplyr::select(name, sequence) %>%
rename(sequence_list_name = name)
sos_consensus = read_csv(here("data", "tip_seqs","destructive", "june_22_consensus.csv")) %>%
clean_names() %>%
dplyr::select(name, sequence) %>%
rename(sequence_list_name = name)
sos_consensus = read_csv(here("data", "tip_seqs","destructive", "june_22_consensus.csv"))
#library(metagenomeSeq)
#library(lubridate)
#library(calecopal)
#library(ape)
#library(bioseq)
#library(dada2)
#library(matrixStats)
library(here)
library(janitor)
library(vegan)
library(tidyverse)
library(bioseq)
library(phyloseq)
library(kmer)
library(dada2)
knitr::opts_chunk$set(echo = TRUE)
sos_consensus = read_csv(here("data", "tip_seqs","destructive", "june_22_consensus.csv")) %>%
clean_names() %>%
dplyr::select(name, sequence) %>%
rename(sequence_list_name = name)
sos_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(sos_consensus)
View(sos_consensus)
View(sos_tips)
knitr::opts_chunk$set(echo = TRUE)
tips_consensus = read_csv(here("data", "tip_seqs","destructive", "june_22_consensus.csv")) %>%
clean_names() %>%
dplyr::select(name, sequence) %>%
rename(sequence_list_name = name)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus)
View(tips_consensus)
View(dest_tips)
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8))
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
mutate(column = substr(location 1,1))
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
mutate(column = substr(location, 1,1))
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
separate(location = c("column", "row"))
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
separate(location = c("column", "row"), sep = "(?=[0-9])(?<=[A-Za-z])")
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8))
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location"))
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
separate(location = c("column", "row"), sep = "(?=[0-9])(?<=[A-Za-z])"))
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
separate(location = c("column", "row"), sep = "(?=[0-9])(?<=[A-Za-z])")
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
separate(location, c("column", "row"), sep = "(?=[0-9])(?<=[A-Za-z])")
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
separate(location, c("column", "row"), sep = "(?<=[A-Za-z])(?=[0-9])")
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
separate(location, c("column", "row"), sep = "(?<=[A-Za-z])(?=[0-9])")
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8))
knitr::opts_chunk$set(echo = TRUE)
strsplit(dest_tips$location,split="(?<=[a-zA-Z])\\s*(?=[0-9])",perl=TRUE)
knitr::opts_chunk$set(echo = TRUE)
strsplit(dest_tips$location,split="(?=[0-9])\\s*(?<=[a-zA-Z])",perl=TRUE)
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
mutate(column = substr(location, 1, length(location)-1))
View(potting)
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
mutate(column = gsub("[^0-9.-]","",x))
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
mutate(column = gsub("[^0-9.-]","",location))
knitr::opts_chunk$set(echo = TRUE)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
mutate(column = gsub("[^0-9.-]","",location)) %>%
mutate(row = gsub("[[:digit:]]","",location))
knitr::opts_chunk$set(echo = TRUE)
master_contigs = read.csv(here("data", "tipstosequence_may2022
.csv")) %>%
clean_names()
knitr::opts_chunk$set(echo = TRUE)
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names()
View(master_contigs)
knitr::opts_chunk$set(echo = TRUE)
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names()
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv"))
View(sample_locations)
View(sample_locations)
sanger_sheet = master_contigs %>%
left_join(sample_locations)
View(sanger_sheet)
knitr::opts_chunk$set(echo = TRUE)
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names()
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv")) %>%
mutate(newplate = substr(newplate, 5,6))%>%
sanger_sheet = master_contigs %>%
left_join(sample_locations)
knitr::opts_chunk$set(echo = TRUE)
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv")) %>%
mutate(newplate = substr(newplate, 5,6) )%>%
sanger_sheet = master_contigs %>%
left_join(sample_locations)
knitr::opts_chunk$set(echo = TRUE)
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names()
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv")) %>%
mutate(newplate = substr(newplate, 5:6))
knitr::opts_chunk$set(echo = TRUE)
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv")) %>%
sanger_sheet = master_contigs %>%
left_join(sample_locations)%>%
mutate(newplate = substr(newplate, 5:6))
knitr::opts_chunk$set(echo = TRUE)
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names()
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv")) %>%
sanger_sheet = master_contigs %>%
left_join(sample_locations)%>%
mutate(newplate = substr(newplate, 5,6))
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv")) %>%
sanger_sheet = master_contigs %>%
left_join(sample_locations)%>%
mutate(newplate = substr(newplate, 5,6))
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv"))
sanger_sheet = master_contigs %>%
left_join(sample_locations)%>%
knitr::opts_chunk$set(echo = TRUE)
sanger_sheet = master_contigs %>%
left_join(sample_locations)%>%
transform(sanger_sheet, newplate = substr(newplate, 5, 6))
knitr::opts_chunk$set(echo = TRUE)
sanger_sheet = master_contigs %>%
left_join(sample_locations)%>%
mutate(newplate = substr(newplate, 5, 6))
knitr::opts_chunk$set(echo = TRUE)
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv")) %>%
sanger_sheet = master_contigs %>%
left_join(sample_locations, by= newplate= old_plate)%>%
knitr::opts_chunk$set(echo = TRUE)
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv")) %>%
sanger_sheet = master_contigs %>%
left_join(sample_locations, by=newplate=old_plate)%>%
knitr::opts_chunk$set(echo = TRUE)
sanger_sheet = master_contigs %>%
left_join(sample_locations, by=newplate)%>%
mutate(newplate = substr(newplate, 5, 6))
knitr::opts_chunk$set(echo = TRUE)
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv")) %>%
sanger_sheet = master_contigs %>%
left_join(sample_locations, by=old_plate)%>%
mutate(newplate = substr(newplate, 5, 6))
sanger_sheet = master_contigs %>%
left_join(sample_locations, by=old_plate)
knitr::opts_chunk$set(echo = TRUE)
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names()
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv")) %>%
sanger_sheet = master_contigs %>%
left_join(sample_locations, by=old_plate)
knitr::opts_chunk$set(echo = TRUE)
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names()
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv")) %>%
sanger_sheet = master_contigs %>%
left_join(sample_locations) %>%
mutate(sanger_sheet, composite_plate = paste(newplate, old_plate))
knitr::opts_chunk$set(echo = TRUE)
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv")) %>%
sanger_sheet = master_contigs %>%
left_join(sample_locations) %>%
mutate(sanger_sheet, composite_plate = paste(newplate, old_plate)) %>%
mutate(newplate = substr(newplate, 5, 6))
knitr::opts_chunk$set(echo = TRUE)
sanger_sheet = master_contigs %>%
left_join(sample_locations) %>%
mutate(sanger_sheet, composite_plate = paste(newplate, old_plate)) %>%
mutate(newplate = substr(newplate, 5, 6))
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names()
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv"))
sanger_sheet = master_contigs %>%
left_join(sample_locations) %>%
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names()
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names()
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv"))
sanger_sheet = master_contigs %>%
left_join(sample_locations)
knitr::opts_chunk$set(echo = TRUE)
tips_consensus = read_csv(here("data", "tip_seqs","destructive", "june_22_consensus.csv")) %>%
clean_names() %>%
dplyr::select(name, sequence) %>%
rename(sequence_list_name = name)
dest_tips = read_csv(here("data", "tip_seqs","destructive", "june_22_contigs.csv")) %>%
clean_names() %>%
separate(name, c("plate", "plate_numbers", "location")) %>%
mutate(plate_number = paste(plate, plate_numbers, sep = "-")) %>%
relocate(plate_number) %>%
dplyr::select(-plate, -plate_numbers) %>%
left_join(tips_consensus) %>%
mutate(plate_number = substr(plate_number, 7,8)) %>%
mutate(column = gsub("[^0-9.-]","",location)) %>%
mutate(row = gsub("[[:digit:]]","",location))
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names()
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv"))
sanger_sheet = master_contigs %>%
left_join(sample_locations) %>%
mutate(sanger_sheet, composite_plate = paste(newplate, old_plate)) %>%
mutate(newplate = substr(newplate, 5, 6))
sanger_sheet = master_contigs %>%
left_join(sample_locations) %>%
mutate(sanger_sheet, composite_plate = paste(newplate, old_plate)) %>%
mutate(newplate = substr(newplate, 5, 6))
sanger_sheet = master_contigs
sanger_sheet = master_contigs %>%
left_join(sample_locations)
knitr::opts_chunk$set(echo = TRUE)
sanger_sheet = master_contigs %>%
left_join(sample_locations) %>%
mutate(newplate = substr(newplate, 5, 6))
unite.ref <- "/Users/Gabe/Desktop/phd/ghecto/unite_db/sh_general_release_s_10.05.2021/sh_general_release_dynamic_s_10.05.2021.fasta"
tiptaxa = assignTaxonomy(sanger_sheet$sequence, unite.ref, multithread = TRUE, tryRC = TRUE)
sos_tiptaxa = tibble(as.data.frame(tiptaxa))
write_csv(dest_tiptaxa, here("data", "dest_tiptaxa_contigs1.csv"))
write_csv(dest_tiptaxa, here("data", "dest_tiptaxa_contigs1.csv"))
unite.ref <- "/Users/Gabe/Desktop/phd/ghecto/unite_db/sh_general_release_s_10.05.2021/sh_general_release_dynamic_s_10.05.2021.fasta"
tiptaxa = assignTaxonomy(sanger_sheet$sequence, unite.ref, multithread = TRUE, tryRC = TRUE)
dest_tiptaxa = tibble(as.data.frame(tiptaxa)) %>%
write_csv(dest_tiptaxa, here("data", "dest_tiptaxa_contigs1.csv"))
knitr::opts_chunk$set(echo = TRUE)
sanger_sheet = master_contigs %>%
left_join(sample_locations) %>%
mutate(newplate = substr(newplate, 5, 6)) %>%
select(-pcr_plate, -pcr_column, -pcr_row, -x)
knitr::opts_chunk$set(echo = TRUE)
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names() %>%
mutate(newplate = substr(newplate, 5, 6))
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv"))
sanger_sheet = master_contigs %>%
left_join(sample_locations) %>%
select(-pcr_plate, -pcr_column, -pcr_row, -x)
knitr::opts_chunk$set(echo = TRUE)
sanger_sheet = master_contigs %>%
left_join(sample_locations) %>%
mutate(newplate = substr(newplate, 5, 6)) %>%
select(-pcr_plate, -pcr_column, -pcr_row, -x)
master_contigs = read.csv(here("data", "tipstosequence_may2022.csv")) %>%
clean_names()
sample_locations = read_csv(here("data", "tips_plate30_31_32.csv"))
sanger_sheet = master_contigs %>%
left_join(sample_locations) %>%
mutate(newplate = substr(newplate, 5, 6)) %>%
select(-pcr_plate, -pcr_column, -pcr_row, -x)
knitr::opts_chunk$set(echo = TRUE)
sanger_sheet = master_contigs %>%
left_join(sample_locations) %>%
mutate(newplate = substr(newplate, 5, 6)) %>%
select(-pcr_plate, -pcr_column, -pcr_row, -x)
tiptaxa = assignTaxonomy(sanger_sheet$sequence, unite.ref, multithread = TRUE, tryRC = TRUE)
dest_tiptaxa = tibble(as.data.frame(tiptaxa)) %>%
mutate(plate = sanger_sheet$plate) %>%
mutate(column = sanger_sheet$column) %>%
mutate(row = sanger_sheet$row)
unite.ref <- sh_general_release_dynamic_s_10.05.2021.fasta
tiptaxa = assignTaxonomy(sanger_sheet$sequence, unite.ref, multithread = TRUE, tryRC = TRUE)
dest_tiptaxa = tibble(as.data.frame(tiptaxa)) %>%
mutate(plate = sanger_sheet$plate) %>%
mutate(column = sanger_sheet$column) %>%
mutate(row = sanger_sheet$row)
unite.ref <- sh_general_release_dynamic_s_10.05.2021.fasta
